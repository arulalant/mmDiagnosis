<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>generate_statistical_score_bars &mdash; mmDiagnosis 1a documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1a',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="mmDiagnosis 1a documentation" href="../index.html" />
    <link rel="up" title="Module code" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../index.html">mmDiagnosis 1a documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for generate_statistical_score_bars</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">.. module:: generate_statistical_score_bars.py</span>
<span class="sd">   :synopsis: This script do plotting the bargraphs of the various statistical</span>
<span class="sd">              score versus threshold in XMGRACE.</span>
<span class="sd">.. moduleauthor:: Dileepkumar R &lt;dileepkunjaai@gmail.com&gt;,</span>
<span class="sd">                  Arulalan.T &lt;arulalant@gmail.com&gt;</span>

<span class="sd">Date : 04.08.2011</span>

<span class="sd">Updated on : 28.09.2011</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">numpy.ma</span>
<span class="kn">import</span> <span class="nn">cdms2</span>
<span class="kn">from</span> <span class="nn">genutil</span> <span class="kn">import</span> <span class="n">xmgrace</span>
<span class="c"># setting the absolute path of the previous directory</span>
<span class="c"># getting the this py module path by __file__ variable</span>
<span class="c"># pass that __file__ to the os.path.dirname, returns the path of this module</span>
<span class="n">__diagnosisDir__</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">)</span>
<span class="n">previousDir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">__diagnosisDir__</span><span class="p">,</span> <span class="s">&#39;..&#39;</span><span class="p">))</span>
<span class="c"># adding the previous path to python path</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">previousDir</span><span class="p">)</span>
<span class="c"># importing plot.py, xml_data_acces.py, TimeUtility from previous directory</span>
<span class="c"># diagnosisutils</span>
<span class="kn">import</span> <span class="nn">diagnosisutils.xml_data_access</span> <span class="kn">as</span> <span class="nn">xml_data_access</span>
<span class="kn">from</span> <span class="nn">diagnosisutils.timeutils</span> <span class="kn">import</span> <span class="n">TimeUtility</span>
<span class="kn">from</span> <span class="nn">diagnosisutils</span> <span class="kn">import</span> <span class="n">numutils</span>
<span class="kn">from</span> <span class="nn">diag_setup.globalconfig</span> <span class="kn">import</span> <span class="n">models</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">processfilesPath</span><span class="p">,</span> \
                               <span class="n">plotsgraphsPath</span><span class="p">,</span> <span class="n">seasons</span>
<span class="kn">from</span> <span class="nn">diag_setup.varsdict</span> <span class="kn">import</span> <span class="n">variables</span>
<span class="kn">from</span> <span class="nn">diag_setup.gendir</span> <span class="kn">import</span> <span class="n">createDirsIfNotExists</span>

<span class="c"># create time utility object</span>
<span class="n">timobj</span> <span class="o">=</span> <span class="n">TimeUtility</span><span class="p">()</span>

<span class="n">regions</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;CIndia&#39;</span><span class="p">:</span> <span class="s">&#39;Central India [73-90E, 22-28N]&#39;</span><span class="p">,</span>
            <span class="s">&#39;PenIndia&#39;</span><span class="p">:</span> <span class="s">&#39;Peninsular India [74-85E, 7-21N]&#39;</span><span class="p">,</span>
            <span class="s">&#39;WcstIndia&#39;</span><span class="p">:</span> <span class="s">&#39;West Coast [70-78E, 10-20N]&#39;</span><span class="p">,</span>
            <span class="s">&#39;AIR&#39;</span><span class="p">:</span> <span class="s">&#39;All India [67-100 E, 7-37N]&#39;</span><span class="p">}</span>


<div class="viewcode-block" id="genSeasonStatiScoreDirs"><a class="viewcode-back" href="../diagnosis.html#generate_statistical_score_bars.genSeasonStatiScoreDirs">[docs]</a><span class="k">def</span> <span class="nf">genSeasonStatiScoreDirs</span><span class="p">(</span><span class="n">modelName</span><span class="p">,</span> <span class="n">modelHour</span><span class="p">,</span> <span class="n">availableMonths</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :func:`genSeasonStatiScoreDirs`: It should generate the directory hierarichy</span>
<span class="sd">        structure of season statiscore in the plotsgraphspath. And calls the</span>
<span class="sd">        function genIsoFillPlots to make &#39;isofill&#39; plots and save it</span>
<span class="sd">        inside the appropirate directory, by reading the nc file of the</span>
<span class="sd">        appropirate process season hour statiscore files path.</span>

<span class="sd">        It should plot for all the vars of that statiscore spatial distributed</span>
<span class="sd">        nc files.</span>

<span class="sd">    Inputs : modelName is the one of the directories name.</span>
<span class="sd">             modelHour is the one of the directories name.</span>
<span class="sd">             availableMonths is the dictionary which is generated by fully</span>
<span class="sd">             available months from the timeAxis.</span>

<span class="sd">    Written By : Arulalan.T</span>

<span class="sd">    Date : 27.09.2011</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">processStatiScorePath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">processfilesPath</span><span class="p">,</span> <span class="n">modelName</span><span class="p">,</span> <span class="s">&#39;StatiScore&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">availableMonths</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="c"># get the months dictionary</span>
        <span class="n">monthdic</span> <span class="o">=</span> <span class="n">availableMonths</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">year</span><span class="p">)</span>
        <span class="c"># sort the months in correct order</span>
        <span class="n">months</span> <span class="o">=</span> <span class="n">timobj</span><span class="o">.</span><span class="n">_sortMonths</span><span class="p">(</span><span class="n">monthdic</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">year</span><span class="p">)</span>
        <span class="n">processStatiSeasonPath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">processStatiScorePath</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="s">&#39;Season&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">seasonName</span><span class="p">,</span> <span class="n">season</span> <span class="ow">in</span> <span class="n">seasons</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="c"># find out xml time axis months has the seasonal months or not</span>
            <span class="n">seasonMonths</span> <span class="o">=</span> <span class="p">[</span><span class="n">month</span> <span class="k">for</span> <span class="n">smonth</span> <span class="ow">in</span> <span class="n">season</span> <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="n">months</span>
                            <span class="k">if</span> <span class="n">smonth</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="n">month</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">seasonMonths</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">season</span><span class="p">):</span>
                <span class="k">print</span> <span class="s">&quot;Got the seasonal months for </span><span class="si">%s</span><span class="s"> season&quot;</span> <span class="o">%</span> <span class="n">seasonName</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">print</span> <span class="s">&quot;Seasonal months are not available for </span><span class="si">%s</span><span class="s"> season&quot;</span> <span class="o">%</span> <span class="n">seasonName</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">seasonName</span><span class="o">.</span><span class="n">isupper</span><span class="p">():</span>
                <span class="n">seasonName</span> <span class="o">=</span> <span class="n">seasonName</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="n">proStatiSeasonChildPath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">processStatiSeasonPath</span><span class="p">,</span> <span class="n">seasonName</span><span class="p">)</span>
            <span class="c"># get the process statistical score Region path</span>
            <span class="n">proStatiRegionPath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">proStatiSeasonChildPath</span><span class="p">,</span> <span class="s">&#39;Region&#39;</span><span class="p">)</span>
            <span class="c"># Do process if process stati score Region directory is exists</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">proStatiRegionPath</span><span class="p">):</span>
                <span class="c"># get the available files from this directory</span>
                <span class="n">files</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">proStatiRegionPath</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">files</span><span class="p">:</span>
                    <span class="k">continue</span>
                    <span class="c"># process empty directory. need to log about this.</span>
                    <span class="c"># process files cant be empty, very less chance.</span>
                <span class="c"># end of if not files:</span>
                <span class="c"># get the nc file name</span>
                <span class="n">ncfiles</span> <span class="o">=</span> <span class="p">[</span><span class="n">ncfile</span> <span class="k">for</span> <span class="n">ncfile</span> <span class="ow">in</span> <span class="n">files</span> <span class="k">if</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">&#39;.nc&#39;</span><span class="p">)</span>\
                <span class="k">if</span> <span class="n">ncfile</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;statistical_score&#39;</span><span class="p">)]</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">ncfile</span><span class="p">:</span>
                    <span class="c"># ncfile is none</span>
                    <span class="k">print</span> <span class="s">&quot;The path </span><span class="si">%s</span><span class="s"> doesnt have nc file&quot;</span> <span class="o">%</span> <span class="n">proStatiRegionPath</span>
                    <span class="k">print</span> <span class="s">&quot;here obtained nc file is </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">ncfile</span>
                    <span class="k">continue</span>

                <span class="c"># create modelName, StatiScore, year, Season, seasonName,</span>
                <span class="c"># Region directories if it is not exists</span>
                <span class="n">plotSeasonRegionPath</span> <span class="o">=</span> <span class="n">createDirsIfNotExists</span><span class="p">(</span><span class="n">plotsgraphsPath</span><span class="p">,</span>
                                            <span class="p">[</span><span class="n">modelName</span><span class="p">,</span> <span class="s">&#39;StatiScore&#39;</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span>
                                            <span class="s">&#39;Season&#39;</span><span class="p">,</span> <span class="n">seasonName</span><span class="p">,</span> <span class="s">&#39;Region&#39;</span><span class="p">])</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">plotSeasonRegionPath</span><span class="p">):</span>
                    <span class="c"># directory is empty. So calling below function</span>
                    <span class="c"># to create all bar diagram plot image files</span>
                    <span class="c"># in stati score Rgion directory of plotsgraphspath.</span>
                    <span class="k">for</span> <span class="n">ncfile</span> <span class="ow">in</span> <span class="n">ncfiles</span><span class="p">:</span>
                        <span class="c"># get the nc file path</span>
                        <span class="n">ncPath</span> <span class="o">=</span> <span class="n">proStatiRegionPath</span> <span class="o">+</span> <span class="s">&#39;/&#39;</span> <span class="o">+</span> <span class="n">ncfile</span>
                        <span class="n">genBarDiagrams</span><span class="p">(</span><span class="n">var</span> <span class="o">=</span> <span class="s">&#39;all&#39;</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="n">ncPath</span><span class="p">,</span>
                                       <span class="n">hours</span> <span class="o">=</span> <span class="n">modelHour</span><span class="p">,</span>
                                       <span class="n">outpath</span> <span class="o">=</span> <span class="n">plotSeasonRegionPath</span><span class="p">)</span>
                    <span class="c"># end of for ncfile in ncfiles:</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">pass</span>
                    <span class="c"># directory is non empty. Have to check either</span>
                    <span class="c"># all vars plots image files are exists or not</span>
                <span class="c"># end of if not os.listdir(plotSeasonRegionPath):</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>
                <span class="c"># the process month name directory not created yet or</span>
                <span class="c"># removed.</span>
            <span class="c"># end of if os.path.isdir(proStatiRegionPath):</span>
        <span class="c"># end of for month in months.keys():</span>
    <span class="c"># end of for year in availableMonths.keys():</span>
    <span class="k">print</span> <span class="s">&quot;Done! creation of Bar diagrams of season stati score for model </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">modelName</span>
<span class="c"># end of def genSeasonStatiScoreDirs(modelName, modelHour, availableMonths):</span>
</div>
<div class="viewcode-block" id="genBarDiagrams"><a class="viewcode-back" href="../diagnosis.html#generate_statistical_score_bars.genBarDiagrams">[docs]</a><span class="k">def</span> <span class="nf">genBarDiagrams</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">hours</span><span class="p">,</span> <span class="n">outpath</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">bargap</span><span class="o">=</span><span class="mf">0.28</span><span class="p">,</span> <span class="n">barwidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
                                                             <span class="n">yticdiff</span><span class="o">=</span><span class="mf">0.25</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :func:`genBarDiagrams`: It should generate the least directory hierarichy</span>
<span class="sd">        structure of season statiscore in the plotsgraphspath by score name.</span>
<span class="sd">        It will plots score values in xmgrace as bar diagram and save it</span>
<span class="sd">        inside the appropirate directory, by reading the nc file of the</span>
<span class="sd">        appropirate process season Region statiscore files path.</span>

<span class="sd">        It should plot for all the vars of that statiscore nc files.</span>

<span class="sd">    Inputs : var is the variable name. If var is &#39;all&#39; means, then it should</span>
<span class="sd">             plot the bar diagram for all the available variables in the passed</span>
<span class="sd">             path nc or xml file.</span>

<span class="sd">             path is an absolute nc or xml file path.</span>

<span class="sd">             outpath is the path to store the images. If it is None means, it</span>
<span class="sd">             should create the least (plotname)directory in the current</span>
<span class="sd">             directory path itself and save it.</span>

<span class="sd">             bargap is the value of the gap ratio in between each bars of each</span>
<span class="sd">             threshold in xaxis of score bar diagram.</span>

<span class="sd">             barwidth is the width of the each bar in xaxis of the score</span>
<span class="sd">             bar diagram.</span>

<span class="sd">             yticdiff is the difference of the tic levels in y axis of the</span>
<span class="sd">             bar diagram.</span>


<span class="sd">    Written By : Dileep Kumar.R, Arulalan.T</span>

<span class="sd">    Updated on : 28.09.2011</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">f</span> <span class="o">=</span> <span class="n">cdms2</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">filelist</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)</span>
    <span class="n">seamon</span> <span class="o">=</span> <span class="n">filelist</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="c"># modelname</span>
    <span class="n">modelname</span> <span class="o">=</span> <span class="n">filelist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="c"># year</span>
    <span class="n">year</span> <span class="o">=</span> <span class="n">filelist</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
    <span class="c"># region</span>
    <span class="n">regionName</span> <span class="o">=</span> <span class="n">filelist</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">allvars</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">if</span> <span class="n">var</span> <span class="o">==</span> <span class="s">&#39;all&#39;</span><span class="p">:</span>
        <span class="c"># var is all. So we have to take all the vars from passed ncpath.</span>
        <span class="n">allvars</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">listvariable</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">var</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;bounds&#39;</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">allvars</span> <span class="o">=</span> <span class="n">var</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">allvars</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span><span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">outpath</span><span class="p">:</span>
        <span class="c"># get the current workig directory</span>
        <span class="n">outpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>

    <span class="c"># setting some intelligent to set xaxis values and its labels depends on</span>
    <span class="c"># no of threshold dynamically</span>
    <span class="n">xdic</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">xval</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">sno</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span><span class="p">(</span><span class="n">i</span><span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">threshold</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">sno</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
            <span class="c"># set xaxis threshold string</span>
            <span class="n">xdic</span><span class="p">[</span><span class="n">sno</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">threshold</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">xval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sno</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># set xaxis empty string</span>
            <span class="n">xdic</span><span class="p">[</span><span class="n">sno</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
        <span class="c"># end of if sno % 2:</span>
        <span class="n">sno</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="c"># end of while(i&lt; len(threshold)):</span>
    <span class="c"># set final xaxis empty string</span>
    <span class="n">xdic</span><span class="p">[</span><span class="n">sno</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
    <span class="c"># xaxis numpy value</span>
    <span class="n">xval</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xval</span><span class="p">)</span>
    <span class="c"># xlist to set xaxis scales min, max value in xmgrace</span>
    <span class="n">xlist</span> <span class="o">=</span> <span class="n">xdic</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="n">xlist</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

    <span class="c"># make hours as int type and do sort</span>
    <span class="n">hours</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">hr</span><span class="p">)</span> <span class="k">for</span> <span class="n">hr</span> <span class="ow">in</span> <span class="n">hours</span><span class="p">]</span>
    <span class="n">hours</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="c"># calculation and generating x axis shift alignments scales for</span>
    <span class="c"># multiple hours bar for single threshold.</span>
    <span class="c"># i.e. setting gap b/w each vertical bar for all the threshold(xaxis)bars</span>
    <span class="n">rem</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">hours</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">leng</span> <span class="o">=</span> <span class="n">rem</span> <span class="o">*</span> <span class="n">bargap</span>
    <span class="n">bar_shift_list</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">leng</span><span class="p">,</span> <span class="n">leng</span> <span class="o">+</span> <span class="n">bargap</span><span class="p">,</span> <span class="n">bargap</span><span class="p">)</span>
    <span class="n">bar_shift_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="n">shift</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">shift</span> <span class="ow">in</span> <span class="n">bar_shift_list</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hours</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">bar_shift_list</span><span class="p">):</span>
        <span class="n">centerindex</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">bar_shift_list</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">bar_shift_list</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">bar_shift_list</span><span class="p">[</span><span class="n">centerindex</span><span class="p">])</span>
    <span class="c"># end of if len(hours) &lt; len(bar_shift_list):</span>

    <span class="c"># make fcst hour name in legend</span>
    <span class="n">legendNames</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">hr</span> <span class="ow">in</span> <span class="n">hours</span><span class="p">:</span>
        <span class="n">day</span> <span class="o">=</span> <span class="n">hr</span> <span class="o">/</span> <span class="mf">24.0</span>
        <span class="c"># keep as float if day is not 24&#39;s multiple</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">hr</span> <span class="o">%</span> <span class="mf">24.0</span><span class="p">:</span>
            <span class="n">day</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">day</span><span class="p">)</span>
        <span class="n">day</span> <span class="o">=</span> <span class="s">&#39;D&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">day</span><span class="p">)</span>
        <span class="n">legendNames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">day</span><span class="p">)</span>
    <span class="c"># end of for hr in hours:</span>

    <span class="c"># colorList is the list of colors of different bars corresponds</span>
    <span class="c"># to forcast hours</span>
    <span class="n">colorList</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;black&#39;</span><span class="p">,</span> <span class="s">&#39;red&#39;</span><span class="p">,</span> <span class="s">&#39;green&#39;</span><span class="p">,</span> <span class="s">&#39;orange&#39;</span><span class="p">,</span> <span class="s">&#39;maroon&#39;</span><span class="p">,</span> <span class="s">&#39;blue&#39;</span><span class="p">,</span> <span class="s">&#39;	turquoise&#39;</span><span class="p">]</span>
    <span class="n">org_yticdiff</span> <span class="o">=</span> <span class="n">yticdiff</span>
    <span class="k">for</span> <span class="n">varName</span> <span class="ow">in</span> <span class="n">allvars</span><span class="p">:</span>
        <span class="n">scoreName</span> <span class="o">=</span> <span class="n">varName</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="c"># make reduce the yaxis tic lables for some scores</span>
        <span class="k">if</span> <span class="n">scoreName</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;ODR&#39;</span><span class="p">]:</span>
            <span class="n">org_yticdiff</span> <span class="o">=</span> <span class="n">yticdiff</span>
            <span class="n">yticdiff</span> <span class="o">=</span> <span class="n">yticdiff</span> <span class="o">*</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># for other scores maintain the function definition value for</span>
            <span class="c"># yticdiff variable</span>
            <span class="n">yticdiff</span> <span class="o">=</span> <span class="n">org_yticdiff</span>
        <span class="c"># create plot name directory if it is not exists</span>
        <span class="n">scoreNamePath</span> <span class="o">=</span> <span class="n">createDirsIfNotExists</span><span class="p">(</span><span class="n">outpath</span><span class="p">,</span> <span class="n">scoreName</span><span class="p">)</span>
        <span class="c"># get the score data</span>
        <span class="n">score</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">varName</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">title_string</span> <span class="o">=</span> <span class="n">score</span><span class="o">.</span><span class="n">long_name</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">title_string</span> <span class="o">=</span> <span class="n">score</span><span class="o">.</span><span class="n">id</span>

        <span class="c"># for condition checking purpose we get the data alone.</span>
        <span class="n">nscore</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>

        <span class="c"># setting y axis min and max values depends upon the min, max of score</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">nscore</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">Y_axis_min</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">nscore</span><span class="p">))</span> <span class="o">-</span> <span class="n">yticdiff</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Y_axis_min</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c"># end of if (numpy.min(nscore) &lt; 0):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">nscore</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">Y_axis_max</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">nscore</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Y_axis_max</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="c"># end of if (numpy.max(nscore) &gt; 1):</span>

        <span class="c"># setting y axis lables dynamically by find round max of score</span>
        <span class="k">if</span> <span class="n">Y_axis_max</span> <span class="o">&gt;=</span> <span class="mf">1e+20</span><span class="p">:</span>
            <span class="n">Y_second_max</span> <span class="o">=</span> <span class="n">numutils</span><span class="o">.</span><span class="n">nextmax</span><span class="p">(</span><span class="n">nscore</span><span class="p">)</span>
            <span class="n">ydicmax</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">Y_second_max</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># change the max level into next to make good view in y axis</span>
            <span class="n">Y_axis_max</span> <span class="o">=</span> <span class="n">Y_axis_max</span> <span class="o">+</span> <span class="n">yticdiff</span>
            <span class="n">ydicmax</span> <span class="o">=</span> <span class="n">Y_axis_max</span>
        <span class="n">ydicmax</span> <span class="o">=</span> <span class="p">(</span><span class="n">ydicmax</span><span class="o">-</span><span class="p">(</span><span class="n">ydicmax</span> <span class="o">%</span> <span class="n">yticdiff</span><span class="p">))</span> <span class="o">+</span> <span class="n">yticdiff</span>
        <span class="c"># get the min value of score</span>
        <span class="n">ydicmin</span> <span class="o">=</span> <span class="n">nscore</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">ydicmin</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ydicmin</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1e+20</span><span class="p">:</span>
                <span class="n">ydicmin</span> <span class="o">=</span> <span class="n">numutils</span><span class="o">.</span><span class="n">nextmin</span><span class="p">(</span><span class="n">nscore</span><span class="p">)</span>
            <span class="c"># -ve value</span>
            <span class="c"># adjust min value by rounding w.r.t yticdiff</span>
            <span class="n">Y_axis_min</span> <span class="o">=</span> <span class="p">(</span><span class="n">ydicmin</span><span class="o">-</span><span class="p">(</span><span class="n">ydicmin</span> <span class="o">%</span> <span class="n">yticdiff</span><span class="p">))</span> <span class="o">-</span> <span class="n">yticdiff</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Y_axis_min</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">Y_second_min</span> <span class="o">=</span> <span class="n">ydicmin</span>
        <span class="c"># generate the ydic values</span>
        <span class="n">ydicval</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">Y_axis_min</span><span class="p">,</span> <span class="n">ydicmax</span> <span class="o">+</span> <span class="n">yticdiff</span><span class="p">,</span> <span class="n">yticdiff</span><span class="p">)</span>

        <span class="n">ydic</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">ydicval</span><span class="p">:</span>
            <span class="n">ydic</span><span class="p">[</span><span class="n">val</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="c"># setting some intelligent to set infinity in y axis label with</span>
        <span class="c"># one interval after the second max of y axis</span>
        <span class="k">if</span> <span class="n">Y_axis_max</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mf">1e+20</span><span class="p">)</span> <span class="ow">or</span> <span class="n">Y_axis_min</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="o">-</span><span class="mf">1e+20</span><span class="p">):</span>
            <span class="c"># setting infinity value</span>
            <span class="n">ydicindex</span> <span class="o">=</span> <span class="n">ydic</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="n">ydicindex</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">ydicindex</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="n">Y_second_max</span><span class="p">:</span>
                    <span class="n">Y_axis_max</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">yticdiff</span>
                    <span class="c"># add one more y axis label at next to next max val</span>
                    <span class="c"># of yaxis scale</span>
                    <span class="n">ydic</span><span class="p">[</span><span class="n">Y_axis_max</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Y_axis_max</span><span class="p">)</span>
                    <span class="c"># set yaxis max val in yaxis lable for infinity case</span>
                    <span class="n">Y_axis_max</span> <span class="o">+=</span> <span class="n">yticdiff</span>
                    <span class="c"># break</span>
                <span class="c"># end of if y &gt;= Y_second_max:</span>
                <span class="k">if</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="n">Y_second_min</span><span class="p">:</span>
                    <span class="n">Y_axis_min</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">yticdiff</span>
                    <span class="c"># add one more y axis label at next to next max val</span>
                    <span class="c"># of yaxis scale</span>
                    <span class="n">ydic</span><span class="p">[</span><span class="n">Y_axis_min</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Y_axis_min</span><span class="p">)</span>
                    <span class="c"># set yaxis max val in yaxis lable for infinity case</span>
                    <span class="n">Y_axis_min</span> <span class="o">-=</span> <span class="n">yticdiff</span>
                <span class="c"># end of if y &gt;= Y_second_max:</span>
            <span class="c"># end of for y in ydicindex:</span>
            <span class="c"># change the y axis max val label by &#39;Infinity&#39; for 1e+20 val in</span>
            <span class="c"># score value</span>
            <span class="n">ydic</span><span class="p">[</span><span class="n">Y_axis_max</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;Infinity&#39;</span>
            <span class="n">ydic</span><span class="p">[</span><span class="n">Y_axis_min</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;-Infinity&#39;</span>
        <span class="c"># end of if Y_axis_max &gt;= (1e+20):</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">xmgrace</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
        <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vymin</span> <span class="o">=</span> <span class="o">.</span><span class="mi">20</span>
        <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vymax</span> <span class="o">=</span> <span class="o">.</span><span class="mi">90</span>
        <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vxmin</span> <span class="o">=</span> <span class="o">.</span><span class="mi">15</span>
        <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vxmax</span> <span class="o">=</span> <span class="o">.</span><span class="mi">88</span>
        <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bar_hgap</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="s">&#39;on&#39;</span>

        <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">title_string</span> <span class="o">+</span> <span class="s">&#39; &#39;</span> <span class="o">+</span> <span class="n">modelname</span> <span class="o">+</span> <span class="s">&#39; &#39;</span> <span class="o">+</span> <span class="n">year</span>
        <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stitle</span> <span class="o">=</span> <span class="n">regions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">regionName</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39; &#39;</span> <span class="o">+</span> <span class="n">seamon</span>
        <span class="c"># ymin for graph 0</span>
        <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="n">Y_axis_min</span>
        <span class="c"># ymax for graph 0</span>
        <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="n">Y_axis_max</span>
        <span class="c"># Main tick every unit</span>
        <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick</span><span class="o">.</span><span class="n">inc</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="c"># 4 sub in between, 1 every .25 units</span>
        <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick</span><span class="o">.</span><span class="n">minor_ticks</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">bar</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="s">&#39;on&#39;</span>
        <span class="c"># setting min value of x axis</span>
        <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="n">xlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c"># setting max value of x axis</span>
        <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="n">xlist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">tick</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">loc</span> <span class="o">=</span> <span class="n">xdic</span>
        <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">tick</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">char_size</span> <span class="o">=</span> <span class="o">.</span><span class="mi">6</span>
        <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">tick</span><span class="o">.</span><span class="n">orientation</span> <span class="o">=</span> <span class="s">&#39;out&#39;</span>
        <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="s">&#39;Rainfall Threshold (cm)&#39;</span>
        <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">loc</span> <span class="o">=</span> <span class="n">ydic</span>
        <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">char_size</span> <span class="o">=</span> <span class="o">.</span><span class="mi">6</span>
        <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick</span><span class="o">.</span><span class="n">orientation</span> <span class="o">=</span> <span class="s">&#39;out&#39;</span>

        <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">title_string</span>
        <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">char_size</span> <span class="o">=</span> <span class="o">.</span><span class="mi">7</span>
        <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="o">.</span><span class="mi">9</span>  <span class="c"># Legend at 90% in x</span>
        <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="o">.</span><span class="mi">8</span>  <span class="c"># Legend at 80% in y</span>

        <span class="k">for</span> <span class="n">setno</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hours</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">setno</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">x</span><span class="o">.</span><span class="n">add_set</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="c"># set bar type</span>
            <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">setno</span><span class="p">]</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s">&#39;bar&#39;</span>
            <span class="c"># Set width of bar</span>
            <span class="c">#x.Graph[0].Set[setno].symbol.size = 1.03</span>
            <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">setno</span><span class="p">]</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">barwidth</span>
            <span class="c"># Set Color</span>
            <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">setno</span><span class="p">]</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">colorList</span><span class="p">[</span><span class="n">setno</span><span class="p">]</span>
            <span class="c"># Switch offing the line which connected on all the bars top edge</span>
            <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">setno</span><span class="p">]</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="c"># Setting the legend</span>
            <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">setno</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span> <span class="o">=</span> <span class="n">legendNames</span><span class="p">[</span><span class="n">setno</span><span class="p">]</span>
            <span class="c"># add the bar_shift_list elements to all the element of threshold</span>
            <span class="n">xshiftval</span> <span class="o">=</span> <span class="n">xval</span> <span class="o">+</span> <span class="n">bar_shift_list</span><span class="p">[</span><span class="n">setno</span><span class="p">]</span>
            <span class="c"># x axis values</span>
            <span class="n">xshiftval</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xshiftval</span><span class="p">)</span>
            <span class="c"># y axis values</span>
            <span class="n">yval</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">score</span><span class="p">(</span><span class="n">fcsthour</span> <span class="o">=</span> <span class="n">hours</span><span class="p">[</span><span class="n">setno</span><span class="p">]))</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
            <span class="c"># Some statistical score takes values -1e+20, for plotting itmakes</span>
            <span class="c"># some problem, threfore we are going to change -1e+20 as 0</span>
            <span class="c"># (Theoriticaly it is not correct)</span>
            <span class="c"># yval = numpy.ma.where(yval !=-1e+20, yval, 0)</span>
            <span class="n">yval</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">yval</span> <span class="o">!=-</span><span class="mf">1e+20</span><span class="p">,</span> <span class="n">yval</span><span class="p">,</span> <span class="n">Y_axis_min</span><span class="p">)</span>
            <span class="c"># plot in xmgrace in the corresponding set of graph</span>
            <span class="n">x</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">yval</span><span class="p">,</span> <span class="n">xshiftval</span><span class="p">,</span> <span class="n">G</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="n">setno</span><span class="p">)</span>
            <span class="n">x</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="c"># end of for setno in range(len(hours)):</span>

        <span class="n">output_filename</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">_</span><span class="si">%s</span><span class="s">_of_</span><span class="si">%s</span><span class="s">_Region_</span><span class="si">%s</span><span class="s">_</span><span class="si">%s</span><span class="s">.jpg&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">modelname</span><span class="p">,</span>
                                        <span class="n">scoreName</span><span class="p">,</span> <span class="n">regionName</span><span class="p">,</span> <span class="n">seamon</span><span class="p">,</span> <span class="n">year</span><span class="p">)</span>
        <span class="n">output_filename</span> <span class="o">=</span> <span class="n">scoreNamePath</span> <span class="o">+</span> <span class="s">&#39;/&#39;</span> <span class="o">+</span> <span class="n">output_filename</span>
        <span class="n">x</span><span class="o">.</span><span class="n">jpeg</span><span class="p">(</span><span class="n">output_filename</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&#39;color&#39;</span><span class="p">,</span> <span class="n">quality</span> <span class="o">=</span> <span class="mi">80</span><span class="p">,</span> <span class="n">dpi</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
                                         <span class="n">smoothing</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">baseline</span> <span class="o">=</span> <span class="s">&#39;off&#39;</span><span class="p">)</span>
    <span class="c"># end of for var in allvars:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="c"># end of def genBarDiagrams(var, path, hours, outpath=None):</span>
</div>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>

    <span class="k">for</span> <span class="n">Model</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
        <span class="n">xmlobj</span> <span class="o">=</span> <span class="n">xml_data_access</span><span class="o">.</span><span class="n">GribXmlAccess</span><span class="p">(</span><span class="n">Model</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
        <span class="c"># get the model variable name from the global &#39;vars.txt&#39;</span>
        <span class="n">mvar</span> <span class="o">=</span> <span class="n">variables</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Model</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model_var</span>
        <span class="n">modeldataset</span> <span class="o">=</span> <span class="n">xmlobj</span><span class="p">[</span><span class="n">mvar</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">]</span>
        <span class="c"># get the timeAxis of modeldata set and correct its bounds</span>
        <span class="n">modeltime</span> <span class="o">=</span> <span class="n">timobj</span><span class="o">.</span><span class="n">_correctTimeAxis</span><span class="p">(</span><span class="n">modeldataset</span><span class="o">.</span><span class="n">getTime</span><span class="p">())</span>
        <span class="c"># get the fully available months</span>
        <span class="n">availableMonths</span> <span class="o">=</span> <span class="n">timobj</span><span class="o">.</span><span class="n">getTimeAxisFullMonths</span><span class="p">(</span><span class="n">modeltime</span><span class="p">)</span>
        <span class="c"># calling func to generate season statiscore directories and its plots</span>
        <span class="n">genSeasonStatiScoreDirs</span><span class="p">(</span><span class="n">Model</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">Model</span><span class="o">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">availableMonths</span><span class="p">)</span>
        <span class="c"># close the xml objects</span>
        <span class="n">xmlobj</span><span class="o">.</span><span class="n">closeXmlObjs</span><span class="p">()</span>
    <span class="c"># end of for model in models:</span>
    <span class="k">print</span> <span class="s">&quot;Done! Creation of all Bar diagrams plots&quot;</span>
<span class="c"># end of if __name__ == &#39;__main__&#39;:</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../index.html">mmDiagnosis 1a documentation</a> &raquo;</li>
          <li><a href="index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2015, Arulalan.T, Dr.Krishna AchutaRao, Dileepkumar.R.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b1.
    </div>
  </body>
</html>