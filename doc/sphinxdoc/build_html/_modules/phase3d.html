<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>phase3d &mdash; mmDiagnosis 1a documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1a',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="mmDiagnosis 1a documentation" href="../index.html" />
    <link rel="up" title="Module code" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../index.html">mmDiagnosis 1a documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for phase3d</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">.. module:: phase3d</span>
<span class="sd">   :synopsis: A useful module for plotting 2 dimensional line diagram among</span>
<span class="sd">              eight phases over timeAxis. phase3d is a generic function to</span>
<span class="sd">              plot any model data and create user&#39;s own functions with</span>
<span class="sd">              customisable args.</span>
<span class="sd">              Also contains mjo_phase3d, miso_phase3d template functions.</span>
<span class="sd">.. moduleauthor:: Arulalan.T &lt;arulalant@gmail.com&gt;</span>
<span class="sd">   License : GPL V3</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">cdutil</span>
<span class="kn">from</span> <span class="nn">genutil</span> <span class="kn">import</span> <span class="n">xmgrace</span>
<span class="kn">import</span> <span class="nn">trig</span>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">time</span>
<span class="c"># setting the absolute path of the previous directory</span>
<span class="c"># getting the this py module path by __file__ variable</span>
<span class="c"># pass that __file__ to the os.path.dirname, returns the path of this module</span>
<span class="n">__curDir__</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">)</span>
<span class="n">diagDir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">__curDir__</span><span class="p">,</span> <span class="s">&#39;../../..&#39;</span><span class="p">))</span>
<span class="c"># adding the previous diagnosisutils path to python path</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diagDir</span><span class="p">)</span>
<span class="c"># import xml_data_acces.py from previous directory diagnosisutils</span>
<span class="kn">from</span> <span class="nn">diagnosisutils.timeutils</span> <span class="kn">import</span> <span class="n">TimeUtility</span>


<span class="n">timobj</span> <span class="o">=</span> <span class="n">TimeUtility</span><span class="p">()</span>


<div class="viewcode-block" id="phase3d"><a class="viewcode-back" href="../mjo.html#phase3d.phase3d">[docs]</a><span class="k">def</span> <span class="nf">phase3d</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">sxyphase</span><span class="p">,</span> <span class="n">dmin</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">dmax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;red&#39;</span><span class="p">],</span>
            <span class="n">tcomment</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">bcomment</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">lcomment</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">rcomment</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="s">&#39;Phase Diagram&#39;</span><span class="p">,</span> <span class="n">stitle1</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">stitle2</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">ctitle</span><span class="o">=</span><span class="s">&#39;Weak&#39;</span><span class="p">,</span>
             <span class="o">**</span><span class="n">kwarg</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    phase3d : This will allow user to plot the 2 dimensional line plot in</span>
<span class="sd">              circular path among 8 phases of 3 dimensional datasets.</span>
<span class="sd">              i.e. pcs1, pcs2 and time are 3 dimensional datasets. It as</span>
<span class="sd">              projected into 2 dimensional line plot. But it actually reprsent</span>
<span class="sd">              3 dimensional dataset. So we named it as phase3d.</span>
<span class="sd">              Also named as phase space diagram.</span>

<span class="sd">    Inputs:</span>
<span class="sd">        xdata : single dimensional xaxis dataset.</span>
<span class="sd">                eg : normalized pc1 time series</span>
<span class="sd">        ydata : single dimensional yaxis dataset.</span>
<span class="sd">                eg : normalized pc2 time series</span>
<span class="sd">                Both xdata &amp; ydata should be continous time series dataset.</span>

<span class="sd">        xdata.id and ydata.id will be set as xaxis &amp; yaxis label.</span>

<span class="sd">        dmin : data min - xaxis and yaxis minimum scale/label value.</span>
<span class="sd">               It must be -ve.</span>
<span class="sd">        dmax : data max - xaxis and yaxis maximum scale/label value.</span>
<span class="sd">               It must be +ve.</span>
<span class="sd">               By default both dmin, dmax takes as None. If it is None, then</span>
<span class="sd">               this function will automatically find out the min &amp; max from</span>
<span class="sd">               the xdata &amp; ydata. Finally set dmin = -dmax. So that we will</span>
<span class="sd">               get squared region.</span>

<span class="sd">        colors : phase line colors. It should be eithre string or list of</span>
<span class="sd">                 colors. If it is string or single color list, the it will</span>
<span class="sd">                 apply that color through out the data line in the graph.</span>
<span class="sd">                 If user passed it as list of colors (more than one colors)</span>
<span class="sd">                 then it will apply those colors to the available months data</span>
<span class="sd">                 set. So make sure that your colorlist and available months</span>
<span class="sd">                 length should be same.</span>

<span class="sd">        tcomment : Top Comment</span>
<span class="sd">        bcomment : Bottom Comment</span>
<span class="sd">        lcomment : Left Comment</span>
<span class="sd">        rcomment : Right Comment</span>
<span class="sd">        title : Title of the diagram</span>
<span class="sd">        stitle1 : Sub Title 1 -</span>
<span class="sd">                  If &#39;year&#39; has passed then it will draw string as start year</span>
<span class="sd">                  and end year from the xdata.</span>
<span class="sd">        stitle2 : Sub Title 2 -</span>
<span class="sd">                  If &#39;month&#39; has passed then it will draw string as season of</span>
<span class="sd">                  available months (from startmonth to endmonth).</span>

<span class="sd">                  If &#39;date&#39; has passed then it will draw string as season of</span>
<span class="sd">                  available dates (from startdate to enddate).</span>

<span class="sd">                  User can overwrite the stitle1 &amp; stitle2 strings.</span>
<span class="sd">        ctitle : Centred Title or text inside the circle.</span>

<span class="sd">        sxyphase : start x, y phase - start x,y points of xdata, ydata phase</span>
<span class="sd">                   number. So user can pass the phase number of the starting</span>
<span class="sd">                   points of the whole data (xdata, ydata). With depends upon</span>
<span class="sd">                   pdirection it will be draw the phase name over the 8</span>
<span class="sd">                   half quadrants of the graph. User no need to pass phase</span>
<span class="sd">                   numbers for the whole datasets (xdata, ydata). Just pass</span>
<span class="sd">                   the first or start day of season phase alone. User can use</span>
<span class="sd">                   pposition1 argument also instead of sxyphase argument.</span>
<span class="sd">                   No default argument takes place here. So user must pass</span>
<span class="sd">                   argument to this sxyphase arg. If user need to use</span>
<span class="sd">                   pposition1 arg, then they must pass None to this sxyphase</span>
<span class="sd">                   argument.</span>
<span class="sd">        KWargs :-</span>
<span class="sd">          pposition1 : phase position 1 - Lets understand the distribution of</span>
<span class="sd">                    8 phases. Lets consider from 0 to 45 degree region as</span>
<span class="sd">                    phase position 1 (pposition1).From 45 to 90 degree region</span>
<span class="sd">                    as phase position 2(pposition2) and so on. So if we walk</span>
<span class="sd">                    in anti-clock wise direction we will endup with pposition8</span>
<span class="sd">                    in the region of 315 to 360 degree.</span>
<span class="sd">                        User can pass argument to pposition1 as integer from</span>
<span class="sd">                    1 to 8. So whatever user passed in the pposition1 phase</span>
<span class="sd">                    number, that phase no string will be draw within in range</span>
<span class="sd">                    from 0 to 45 degree.</span>
<span class="sd">                       eg : pposition1=5 . i.e. phase name &#39;PHASE 5&#39; will be</span>
<span class="sd">                            drawn in the 0 to 45 degree region of the graph.</span>

<span class="sd">                       By default it takes None argument.</span>

<span class="sd">                    ..note:: User can not use both sxyphase and pposition1</span>
<span class="sd">                             args. Can be used either sxyphase or pposition1</span>
<span class="sd">                             only.</span>

<span class="sd">          pdirection : phase direction - It can be either &#39;clock&#39; or &#39;anticlock&#39;</span>
<span class="sd">                     It will determine what is the phase number in the</span>
<span class="sd">                     pposition2, pposition3, ..., pposition8 w.r.t the input</span>
<span class="sd">                     of pposition1 argument or sxyphase and clock/anticlock</span>
<span class="sd">                     direction.</span>
<span class="sd">                     eg 1: pposition1 = 5, pdirection = &#39;anticlock&#39;</span>
<span class="sd">                       pposition1=5, pposition2=6, pposition3=7, pposition4=8,</span>
<span class="sd">                       pposition5=1, pposition6=2, pposition7=3, pposition8=4.</span>

<span class="sd">                     i.e. w.r.t pposition1 as 5 and pdirection as &#39;anticlock&#39;</span>
<span class="sd">                          the phase names of the rest phase positions are</span>
<span class="sd">                        determined as increment trend of pnames in ppositions.</span>

<span class="sd">                   eg 2: pposition1 = 5, pdirection = &#39;clock&#39;</span>
<span class="sd">                       pposition1=5, pposition2=4, pposition3=3, pposition4=2,</span>
<span class="sd">                       pposition5=1, pposition6=8, pposition7=7, pposition8=6.</span>

<span class="sd">                     i.e. w.r.t pposition1 as 5 and pdirection as &#39;clock&#39;</span>
<span class="sd">                          the phase names of the rest phase positions are</span>
<span class="sd">                        determined as decrement trend of pnames in ppositions.</span>

<span class="sd">                     same examples we can play with sxyphase also.</span>

<span class="sd">          plocation : It takes input as &#39;in/inside/out/outside&#39;. If it is</span>
<span class="sd">                    &#39;in&#39; or &#39;inside&#39;, then the phase name/number will be drawn</span>
<span class="sd">                    inside the squared graph itself.</span>
<span class="sd">                    If it is &#39;out&#39; or &#39;outside&#39;, then the phase name/number</span>
<span class="sd">                    will be drawn outside the squared graph.</span>
<span class="sd">          mintick : minor ticks count. By default it takes as 0. user can pass 4</span>
<span class="sd">                    also.</span>

<span class="sd">          timeorder : It takes a list of nos which representing the month order</span>
<span class="sd">                      from 1 to 12. It could be any order. If user has passed any</span>
<span class="sd">                      order of nos in this, then line plots will be plotted in</span>
<span class="sd">                      the passed months order. By default it takes None. In that</span>
<span class="sd">                      case the data months wil be sorted in the correct order,</span>
<span class="sd">                      then that will be plotted.</span>
<span class="sd">                      eg : timeorder=[11, 12, 1, 2, 3, 4] . This will be useful</span>
<span class="sd">                      to plot winter season when we have only one year data.</span>
<span class="sd">                      So user has to enable both cyclic=True and timeorder as</span>
<span class="sd">                      the above list. Then it will be plotted as NDJFMA.</span>
<span class="sd">                      Otherwise it will plot as JFMAND &amp; make looks like mess-up.</span>
<span class="sd">                      For cyclic option refer timeutils.getSeasonData().</span>

<span class="sd">    Methods Used : _sortMonths, getTimeAxisMonths, getHalfQuadrantOfCircle</span>

<span class="sd">    Return :</span>
<span class="sd">        It should return the &#39;x&#39; of the xmgrace object which has plotted the</span>
<span class="sd">        data with this MJO args. User can either save it into ps, pdf, etc.,</span>
<span class="sd">        or modify/update further.</span>

<span class="sd">    Author : Arulalan.T</span>

<span class="sd">    Date : 20.02.2013</span>

<span class="sd">    License : GPL V3</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">timeOrder</span> <span class="o">=</span> <span class="n">kwarg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;timeorder&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="n">pposition1</span> <span class="o">=</span> <span class="n">kwarg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;pposition1&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
    <span class="n">pdirection</span> <span class="o">=</span> <span class="n">kwarg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;pdirection&#39;</span><span class="p">,</span> <span class="s">&#39;anticlock&#39;</span><span class="p">)</span>
    <span class="n">plocation</span> <span class="o">=</span> <span class="n">kwarg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;plocation&#39;</span><span class="p">,</span> <span class="s">&#39;in&#39;</span><span class="p">)</span>
    <span class="n">mintick</span> <span class="o">=</span> <span class="n">kwarg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;mintick&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">credits</span> <span class="o">=</span> <span class="s">&quot;Created by : IIT-Delhi Dr.Krishna AchutaRao, Arulalan.T  Using UVCDAT 1.3.1.   &quot;</span>
    <span class="n">credits</span> <span class="o">+=</span> <span class="s">&quot;Testing Version : 0.1a&quot;</span>

    <span class="k">if</span> <span class="n">timeOrder</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">timeOrder</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;timerrder arg must be list or tuple contains the month no/index.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sxyphase</span> <span class="ow">and</span> <span class="n">pposition1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;pass either sxyphase or pposition1 argument.</span><span class="se">\</span>
<span class="s">                                                Dont pass both args!&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">sxyphase</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">pposition1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;You must pass either sxyphase or pposition1 argument&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sxyphase</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sxyphase</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;sxyphase argument must be integer type&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sxyphase</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">sxyphase</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;sxyphase argument must be within 1 to 8 only!&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">pposition1</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pposition1</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;pposition1 argument must be integer type&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pposition1</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">pposition1</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;pposition1 argument must be within 1 to 8 only!&quot;</span><span class="p">)</span>

    <span class="c"># create our xmgrace object</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">xmgrace</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
    <span class="n">x</span><span class="o">.</span><span class="n">portrait</span><span class="p">()</span>

    <span class="c"># Now let&#39;s set the area of graph 0</span>
    <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vymin</span> <span class="o">=</span> <span class="o">.</span><span class="mi">20</span>  <span class="c"># starts at 55% of the page</span>
    <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vymax</span> <span class="o">=</span> <span class="o">.</span><span class="mi">75</span>   <span class="c"># stops at 90% of the page</span>
    <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vxmin</span> <span class="o">=</span> <span class="o">.</span><span class="mi">15</span>  <span class="c"># starts at 10% of the page</span>
    <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vxmax</span> <span class="o">=</span> <span class="o">.</span><span class="mi">90</span>   <span class="c"># stops at 75% of the page</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">dmin</span> <span class="ow">and</span> <span class="n">dmax</span><span class="p">):</span>
        <span class="c"># user not passed the data min &amp; data max values.</span>
        <span class="c"># So what, lets find it !</span>
        <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">xdata</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">xdata</span><span class="p">)</span>
        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">ydata</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">ydata</span><span class="p">)</span>
        <span class="n">dmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span><span class="p">])</span>
        <span class="n">dmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dmin</span><span class="p">)</span> <span class="o">==</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dmax</span><span class="p">):</span>
            <span class="n">dmax</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">dmax</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">dmax</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span> <span class="n">dmax</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dmax</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="nb">max</span><span class="p">([</span><span class="nb">abs</span><span class="p">(</span><span class="n">dmin</span><span class="p">),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dmax</span><span class="p">)]))</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="c"># end of if abs(umin) == abs(umax):</span>
        <span class="n">dmin</span> <span class="o">=</span> <span class="o">-</span><span class="n">dmax</span>
    <span class="c"># end of if not (min and max):</span>

    <span class="c"># ok now let&#39;s set the min ans max for the Y axis</span>
    <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="n">dmin</span>  <span class="c"># ymin for graph 0</span>
    <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="n">dmax</span>  <span class="c"># ymax for graph 0</span>

    <span class="c"># Now let&#39;s set the tick marks for Graph 0</span>
    <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick</span><span class="o">.</span><span class="n">inc</span> <span class="o">=</span> <span class="mi">1</span>   <span class="c"># Main tick every unit</span>
    <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick</span><span class="o">.</span><span class="n">minor_ticks</span> <span class="o">=</span> <span class="n">mintick</span>

    <span class="c"># ok now let&#39;s set the min ans max for the X axis</span>
    <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="n">dmin</span>  <span class="c"># xmin for graph 0</span>
    <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="n">dmax</span>  <span class="c"># xmax for graph 0</span>

    <span class="c"># Now let&#39;s set the tick marks for Graph 0</span>
    <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">tick</span><span class="o">.</span><span class="n">inc</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c"># Main tick every unit</span>
    <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">tick</span><span class="o">.</span><span class="n">minor_ticks</span> <span class="o">=</span> <span class="n">mintick</span>

    <span class="k">for</span> <span class="n">setno</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">setno</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c"># adding set to graph 0 to add lines</span>
            <span class="n">x</span><span class="o">.</span><span class="n">add_set</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="c"># end of if setno != 0:</span>
        <span class="c"># First let&#39;s set the line width, style, color</span>
        <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">setno</span><span class="p">]</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">setno</span><span class="p">]</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="s">&#39;black&#39;</span>
        <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">setno</span><span class="p">]</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">linestyle</span> <span class="o">=</span> <span class="s">&#39;solid&#39;</span>
    <span class="c"># end of for setno in range(4):</span>

    <span class="c"># line co-ordinates points</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">p2</span> <span class="o">=</span> <span class="p">[</span><span class="n">dmin</span><span class="p">,</span> <span class="n">dmax</span><span class="p">]</span>
    <span class="n">p3</span> <span class="o">=</span> <span class="p">[</span><span class="n">dmax</span><span class="p">,</span> <span class="n">dmin</span><span class="p">]</span>
    <span class="c"># line x, y co-ordinates</span>
    <span class="n">lines1</span> <span class="o">=</span> <span class="p">[</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p2</span><span class="p">]</span>
    <span class="n">lines2</span> <span class="o">=</span> <span class="p">[</span><span class="n">p2</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">]</span>
    <span class="c"># plotting + and x cross lines to connect all the corners of the graph.</span>
    <span class="n">x</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lines1</span><span class="p">,</span> <span class="n">xs</span><span class="o">=</span><span class="n">lines2</span><span class="p">)</span>

    <span class="c"># adding set to graph 0 to add the centred circle</span>
    <span class="n">csetno</span> <span class="o">=</span> <span class="n">setno</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">x</span><span class="o">.</span><span class="n">add_set</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="c"># set centred circle properties</span>
    <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">csetno</span><span class="p">]</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="c"># circle should follow its path on these conditions/points</span>
    <span class="c"># (x=1, y=0),(x=-1, y=0),(x=0,y=1),(x=0,y=-1).</span>
    <span class="c"># We set size of the circle according to the above rules!</span>
    <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">csetno</span><span class="p">]</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="mf">9.175</span>
    <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">csetno</span><span class="p">]</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="s">&#39;black&#39;</span>
    <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">csetno</span><span class="p">]</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">fcolor</span> <span class="o">=</span> <span class="s">&#39;white&#39;</span>
    <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">csetno</span><span class="p">]</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">linestyle</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">csetno</span><span class="p">]</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="c"># plotting the centred circle</span>
    <span class="n">x</span><span class="o">.</span><span class="n">plot</span><span class="p">([[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">G</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">S</span><span class="o">=</span><span class="n">csetno</span><span class="p">)</span>

    <span class="c"># to point the starting day of event, set its x, y, color properties</span>
    <span class="n">start_x</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">start_y</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">start_clr</span> <span class="o">=</span> <span class="s">&#39;red&#39;</span>

    <span class="c"># plot type</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">ptype</span> <span class="o">=</span> <span class="s">&#39;single&#39;</span>
        <span class="n">start_clr</span> <span class="o">=</span> <span class="n">colors</span>
    <span class="k">elif</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">ptype</span> <span class="o">=</span> <span class="s">&#39;single&#39;</span>
        <span class="n">start_clr</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">ptype</span> <span class="o">=</span> <span class="s">&#39;multi&#39;</span>
        <span class="n">avlColors</span> <span class="o">=</span> <span class="n">colors</span>
    <span class="c"># end of if isinstance(colors, str):</span>

    <span class="k">if</span> <span class="n">ptype</span> <span class="o">==</span> <span class="s">&#39;single&#39;</span><span class="p">:</span>
        <span class="n">csetno</span> <span class="o">=</span> <span class="n">csetno</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">x</span><span class="o">.</span><span class="n">add_set</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="c"># set the line properties color &amp; inter points color, size</span>
        <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">csetno</span><span class="p">]</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">csetno</span><span class="p">]</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">start_clr</span>
        <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">csetno</span><span class="p">]</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">linestyle</span> <span class="o">=</span> <span class="s">&#39;solid&#39;</span>
        <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">csetno</span><span class="p">]</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">csetno</span><span class="p">]</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="mf">0.125</span>
        <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">csetno</span><span class="p">]</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">start_clr</span>
        <span class="c"># plotting the xdata, ydata in circle manner</span>
        <span class="n">x</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ydata</span><span class="p">,</span> <span class="n">xs</span><span class="o">=</span><span class="n">xdata</span><span class="p">,</span> <span class="n">G</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">S</span><span class="o">=</span><span class="n">csetno</span><span class="p">)</span>
        <span class="c"># to point the starting day of event by filled color square symbol</span>
        <span class="c"># set its start_x, start_y</span>
        <span class="n">start_x</span> <span class="o">=</span> <span class="n">xdata</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">start_y</span> <span class="o">=</span> <span class="n">ydata</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">elif</span> <span class="n">ptype</span> <span class="o">==</span> <span class="s">&#39;multi&#39;</span><span class="p">:</span>
        <span class="c"># available months in dictionary format contains years, month string</span>
        <span class="c"># and dates</span>
        <span class="n">xtimeAxis</span> <span class="o">=</span> <span class="n">xdata</span><span class="o">.</span><span class="n">getTime</span><span class="p">()</span>
        <span class="n">ytimeAxis</span> <span class="o">=</span> <span class="n">ydata</span><span class="o">.</span><span class="n">getTime</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">xtimeAxis</span><span class="p">[:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">!=</span> <span class="n">ytimeAxis</span><span class="p">[:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;xdata (</span><span class="si">%s</span><span class="s">), ydata (</span><span class="si">%s</span><span class="s">) time axis are not same!&quot;</span>
                                                     <span class="o">%</span> <span class="p">(</span><span class="n">xdata</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">ydata</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>
        <span class="c"># end of if xtimeAxis[:].tolist() != ytimeAxis[:].tolist():</span>
        <span class="n">cdutil</span><span class="o">.</span><span class="n">setAxisTimeBoundsDaily</span><span class="p">(</span><span class="n">xtimeAxis</span><span class="p">)</span>
        <span class="n">avlMonths</span> <span class="o">=</span> <span class="n">timobj</span><span class="o">.</span><span class="n">getTimeAxisMonths</span><span class="p">(</span><span class="n">xtimeAxis</span><span class="p">)</span>
        <span class="n">avlMonthsList</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">avlMonths</span><span class="p">:</span>
            <span class="n">months</span> <span class="o">=</span> <span class="n">avlMonths</span><span class="p">[</span><span class="n">year</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">timeOrder</span><span class="p">:</span>
                <span class="c"># get the user defined order of month strings</span>
                <span class="n">months</span> <span class="o">=</span> <span class="p">[</span><span class="n">cdutil</span><span class="o">.</span><span class="n">getMonthString</span><span class="p">(</span><span class="n">mo</span><span class="p">)</span> <span class="k">for</span> <span class="n">mo</span> <span class="ow">in</span> <span class="n">timeOrder</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c"># sort the month strings in ascending order</span>
                <span class="n">months</span> <span class="o">=</span> <span class="n">timobj</span><span class="o">.</span><span class="n">_sortMonths</span><span class="p">(</span><span class="n">months</span><span class="p">)</span>
            <span class="c"># end of if timeOrder:</span>
            <span class="k">for</span> <span class="n">mon</span> <span class="ow">in</span> <span class="n">months</span><span class="p">:</span>
                <span class="n">avlMonthsList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">mon</span><span class="p">,</span> <span class="n">avlMonths</span><span class="p">[</span><span class="n">year</span><span class="p">][</span><span class="n">mon</span><span class="p">]))</span>
            <span class="c"># end of for mon in months:</span>
        <span class="c"># end of for year in avlMonths:</span>

        <span class="c"># innter lock connection months</span>
        <span class="n">conMonths</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c"># now lets do innter lock connection between months last &amp; first date</span>
        <span class="n">preMonthLastDate</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">avlYears</span> <span class="o">=</span> <span class="n">avlMonths</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">mon</span><span class="p">,</span> <span class="p">(</span><span class="n">fdate</span><span class="p">,</span> <span class="n">ldate</span><span class="p">))</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">avlMonthsList</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="p">(</span><span class="n">mon</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;JANUARY&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">avlYears</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                <span class="c"># If user passed timeorder as [11, 12, 1, 2, ...] then while</span>
                <span class="c"># extracting January if we set 12th month for the same year,</span>
                <span class="c"># then we need to start with first date. Not from the year-12-31.</span>
                <span class="n">conMonths</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">mon</span><span class="p">,</span> <span class="p">(</span><span class="n">fdate</span><span class="p">,</span> <span class="n">ldate</span><span class="p">)))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c"># previous month&#39;s last date as first day of this month &amp;</span>
                <span class="c"># this month last date for the purpose of continous line plot</span>
                <span class="c"># while changing colors for different months.</span>
                <span class="n">conMonths</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">mon</span><span class="p">,</span> <span class="p">(</span><span class="n">preMonthLastDate</span><span class="p">,</span> <span class="n">ldate</span><span class="p">)))</span>
            <span class="c"># end of if idx == 0 or ...:</span>
            <span class="n">preMonthLastDate</span> <span class="o">=</span> <span class="n">ldate</span>
        <span class="c"># end of for idx, fdate, ldate in enumerate(avlMonthsList):</span>
        <span class="c"># make memory free</span>
        <span class="k">del</span> <span class="n">avlMonths</span><span class="p">,</span> <span class="n">avlMonthsList</span>

        <span class="c"># month string x position to indicate below the graph with</span>
        <span class="c"># corresponding line color</span>
        <span class="n">monx</span> <span class="o">=</span> <span class="mf">0.4</span>
        <span class="k">for</span> <span class="n">montime</span><span class="p">,</span> <span class="n">colr</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">conMonths</span><span class="p">,</span> <span class="n">avlColors</span><span class="p">):</span>
            <span class="c"># get the month name string</span>
            <span class="n">mon</span> <span class="o">=</span> <span class="n">montime</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="c"># month first last component time object date</span>
            <span class="n">monFLDate</span> <span class="o">=</span> <span class="n">montime</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="c"># get the current month pc1 and pc2 data</span>
            <span class="n">pc1</span> <span class="o">=</span> <span class="n">xdata</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">monFLDate</span><span class="p">)</span>
            <span class="n">pc2</span> <span class="o">=</span> <span class="n">ydata</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">monFLDate</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">monx</span> <span class="o">==</span> <span class="mf">0.4</span><span class="p">:</span>
                <span class="c"># do it only one time, assign the first day of first month to</span>
                <span class="c"># start_x, start_y, color to point the starting day of event</span>
                <span class="c"># by filled color square symbol</span>
                <span class="n">start_x</span> <span class="o">=</span> <span class="n">pc1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">start_y</span> <span class="o">=</span> <span class="n">pc2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="c"># set the starting color as begining of multi color list</span>
                <span class="n">start_clr</span> <span class="o">=</span> <span class="n">colr</span>
            <span class="c"># end of if monx == 0.4:</span>
            <span class="n">csetno</span> <span class="o">=</span> <span class="n">csetno</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">x</span><span class="o">.</span><span class="n">add_set</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="c"># set the line properties color &amp; inter points color, size</span>
            <span class="c"># for this month dataset</span>
            <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">csetno</span><span class="p">]</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">csetno</span><span class="p">]</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">colr</span>
            <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">csetno</span><span class="p">]</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">linestyle</span> <span class="o">=</span> <span class="s">&#39;solid&#39;</span>
            <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">csetno</span><span class="p">]</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">csetno</span><span class="p">]</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="mf">0.125</span>
            <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">csetno</span><span class="p">]</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">colr</span>
            <span class="c"># plotting the xdata, ydata in circle manner</span>
            <span class="n">x</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pc2</span><span class="p">,</span> <span class="n">xs</span><span class="o">=</span><span class="n">pc1</span><span class="p">,</span> <span class="n">G</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">S</span><span class="o">=</span><span class="n">csetno</span><span class="p">)</span>
            <span class="c"># darw the month string with same as color of that month line</span>
            <span class="c"># color to indicate monthly event</span>
            <span class="n">x</span><span class="o">.</span><span class="n">add_string</span><span class="p">(</span><span class="n">monx</span><span class="p">,</span> <span class="mf">0.09</span><span class="p">,</span> <span class="n">mon</span><span class="p">[:</span><span class="mi">3</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">colr</span><span class="p">,</span>
                            <span class="n">char_size</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">just</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
            <span class="c"># increment the month string position</span>
            <span class="n">monx</span> <span class="o">+=</span> <span class="mf">0.05</span>
        <span class="c"># end of for mon, colr in zip(conMonths, avlColors):</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Wrong plot &#39;</span><span class="si">%s</span><span class="s">&#39; type has passed. </span><span class="se">\</span>
<span class="s">                          Pass either &#39;single&#39; or &#39;multi&#39;&quot;</span> <span class="o">%</span> <span class="n">ptype</span><span class="p">)</span>
    <span class="c"># end of if ptype == &#39;single&#39;:</span>

    <span class="c"># adding set to draw a small square symbol at the begining of the season.</span>
    <span class="c"># it must be square symbol only. Becuause we can not plot this symbol</span>
    <span class="c"># out side of the graph, using viewport.</span>
    <span class="n">csetno</span> <span class="o">=</span> <span class="n">csetno</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">x</span><span class="o">.</span><span class="n">add_set</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">csetno</span><span class="p">]</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c"># &#39;square&#39; type</span>
    <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">csetno</span><span class="p">]</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="mf">0.45</span>
    <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">csetno</span><span class="p">]</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">start_clr</span>
    <span class="n">x</span><span class="o">.</span><span class="n">Graph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">csetno</span><span class="p">]</span><span class="o">.</span><span class="n">symbol</span><span class="o">.</span><span class="n">fcolor</span> <span class="o">=</span> <span class="n">start_clr</span>
    <span class="n">x</span><span class="o">.</span><span class="n">plot</span><span class="p">([[</span><span class="n">start_y</span><span class="p">]],</span> <span class="p">[[</span><span class="n">start_x</span><span class="p">]],</span> <span class="n">G</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">S</span><span class="o">=</span><span class="n">csetno</span><span class="p">)</span>

    <span class="c"># Since we can not use viewport to plot the symbol to indicate what the</span>
    <span class="c"># above square symbol meant to be, here we are using add_box function to</span>
    <span class="c"># draw a small square below the graph with text &#39;Start day of season&#39;.</span>
    <span class="n">x</span><span class="o">.</span><span class="n">add_box</span><span class="p">(</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.158</span><span class="p">,</span> <span class="mf">0.758</span><span class="p">,</span> <span class="mf">0.164</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">start_clr</span><span class="p">,</span> <span class="n">fillcolor</span><span class="o">=</span><span class="n">start_clr</span><span class="p">)</span>
    <span class="c"># drawing the text behind to the above small square box</span>
    <span class="n">x</span><span class="o">.</span><span class="n">add_string</span><span class="p">(</span><span class="mf">0.83</span><span class="p">,</span> <span class="mf">0.16</span><span class="p">,</span> <span class="s">&#39;Start day of season&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">,</span>
                                    <span class="n">char_size</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">just</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="c"># draw the xdata id as xaxis label</span>
    <span class="n">x</span><span class="o">.</span><span class="n">add_string</span><span class="p">(</span><span class="mf">0.53</span><span class="p">,</span> <span class="mf">0.16</span><span class="p">,</span> <span class="n">xdata</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">,</span> <span class="n">char_size</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
                                                     <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">just</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="c"># draw the ydata id as yaxis label</span>
    <span class="n">x</span><span class="o">.</span><span class="n">add_string</span><span class="p">(</span><span class="mf">0.10</span><span class="p">,</span> <span class="mf">0.48</span><span class="p">,</span> <span class="n">ydata</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">,</span> <span class="n">char_size</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
                                                    <span class="n">rot</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">just</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="c"># draw the bottom comment</span>
    <span class="n">x</span><span class="o">.</span><span class="n">add_string</span><span class="p">(</span><span class="mf">0.53</span><span class="p">,</span> <span class="mf">0.13</span><span class="p">,</span> <span class="n">bcomment</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;blue&#39;</span><span class="p">,</span> <span class="n">char_size</span><span class="o">=</span><span class="mf">1.3</span><span class="p">,</span>
                                                     <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">just</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="c"># draw the top comment</span>
    <span class="n">x</span><span class="o">.</span><span class="n">add_string</span><span class="p">(</span><span class="mf">0.53</span><span class="p">,</span> <span class="mf">0.81</span><span class="p">,</span> <span class="n">tcomment</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;blue&#39;</span><span class="p">,</span> <span class="n">char_size</span><span class="o">=</span><span class="mf">1.3</span><span class="p">,</span>
                                                     <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">just</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="c"># draw the left comment</span>
    <span class="n">x</span><span class="o">.</span><span class="n">add_string</span><span class="p">(</span><span class="mf">0.06</span><span class="p">,</span> <span class="mf">0.48</span><span class="p">,</span> <span class="n">lcomment</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;blue&#39;</span><span class="p">,</span> <span class="n">char_size</span><span class="o">=</span><span class="mf">1.3</span><span class="p">,</span>
                                                    <span class="n">rot</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">just</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="c"># draw the right comment</span>
    <span class="n">x</span><span class="o">.</span><span class="n">add_string</span><span class="p">(</span><span class="mf">0.97</span><span class="p">,</span> <span class="mf">0.48</span><span class="p">,</span> <span class="n">rcomment</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;blue&#39;</span><span class="p">,</span> <span class="n">char_size</span><span class="o">=</span><span class="mf">1.3</span><span class="p">,</span>
                                                   <span class="n">rot</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span> <span class="n">just</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">dmax</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="c"># phase quadrant/positions no, and its x, y coordinate points to draw</span>
        <span class="c"># phase name inside the graph</span>
        <span class="n">phases_loc_in</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.25</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">2.15</span><span class="p">)),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.25</span><span class="p">,</span> <span class="mf">2.15</span><span class="p">)),</span>
                      <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.75</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.75</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.35</span><span class="p">)),</span>
                      <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.65</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.35</span><span class="p">)),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.25</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
        <span class="c"># phase quadrant/positions no, its x, y coordinate points to draw</span>
        <span class="c"># phase name and its rotation(direction) outside the graph</span>
        <span class="n">phases_loc_out</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mf">2.25</span><span class="p">,</span> <span class="mf">1.75</span><span class="p">),</span> <span class="mi">270</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">2.25</span><span class="p">),</span> <span class="mi">0</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.25</span><span class="p">,</span> <span class="mf">2.25</span><span class="p">),</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mf">2.25</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">90</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mf">2.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">),</span> <span class="mi">90</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.4</span><span class="p">),</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.65</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.4</span><span class="p">),</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="p">(</span><span class="mf">2.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.25</span><span class="p">),</span> <span class="mi">270</span><span class="p">))</span>
            
    <span class="k">elif</span> <span class="n">dmax</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">:</span>
        <span class="c"># phase quadrant/positions no, and its x, y coordinate points to draw</span>
        <span class="c"># phase name inside the graph</span>
        <span class="n">phases_loc_in</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mf">2.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">3.25</span><span class="p">)),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">3.25</span><span class="p">)),</span>
                      <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mf">2.6</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mf">2.6</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.5</span><span class="p">)),</span>
                      <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.5</span><span class="p">)),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="p">(</span><span class="mf">2.1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
        <span class="c"># phase quadrant/positions no, its x, y coordinate points to draw</span>
        <span class="c"># phase name and its rotation(direction) outside the graph</span>
        <span class="n">phases_loc_out</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mf">3.25</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">),</span> <span class="mi">270</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">3.25</span><span class="p">),</span> <span class="mi">0</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">3.25</span><span class="p">),</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mf">3.35</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">),</span> <span class="mi">90</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mf">3.35</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5</span><span class="p">),</span> <span class="mi">90</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.65</span><span class="p">),</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.65</span><span class="p">),</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="p">(</span><span class="mf">3.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">),</span> <span class="mi">270</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">dmax</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">:</span>
        <span class="c"># phase quadrant/positions no, and its x, y coordinate points to draw</span>
        <span class="c"># phase name inside the graph</span>
        <span class="n">phases_loc_in</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mf">2.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">)),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">)),</span>
                      <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mf">3.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mf">3.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.5</span><span class="p">)),</span>
                      <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.5</span><span class="p">)),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="p">(</span><span class="mf">2.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
        <span class="c"># phase quadrant/positions no, its x, y coordinate points to draw</span>
        <span class="c"># phase name and its rotation(direction) outside the graph</span>
        <span class="n">phases_loc_out</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mf">4.25</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">),</span> <span class="mi">270</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">4.25</span><span class="p">),</span> <span class="mi">0</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">4.25</span><span class="p">),</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mf">4.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">),</span> <span class="mi">90</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mf">4.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5</span><span class="p">),</span> <span class="mi">90</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.65</span><span class="p">),</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.65</span><span class="p">),</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="p">(</span><span class="mf">4.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">),</span> <span class="mi">270</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Method Not Implemented Yet. </span><span class="se">\</span>
<span class="s">                        Just add the phase location for the dmax=</span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">dmax</span><span class="p">)</span>
    <span class="c"># end of if dmax == 3:</span>

    <span class="c"># general phase sequence</span>
    <span class="n">phase_sequence</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">sxyphase</span><span class="p">:</span>
        <span class="c"># passed start x, y points of xdata, ydata phase name/number.</span>
        <span class="c"># assign the above phase name/number of start x, y points</span>
        <span class="c"># of xdata, ydata</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">sxyphase</span>
        <span class="c"># get the actual half quadrant of the circle of the start x, y points</span>
        <span class="c"># of xdata, ydata. subtract 1 for python index access of list.</span>
        <span class="n">hq</span> <span class="o">=</span> <span class="n">trig</span><span class="o">.</span><span class="n">getHalfQuadrantOfCircle</span><span class="p">(</span><span class="n">start_x</span><span class="p">,</span> <span class="n">start_y</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="c"># reorder the phase_sequence w.r.t starting x,y points of xdata,ydata</span>
        <span class="n">phase_sequence</span> <span class="o">=</span> <span class="n">phase_sequence</span><span class="p">[</span><span class="n">hq</span><span class="p">:]</span> <span class="o">+</span> <span class="n">phase_sequence</span><span class="p">[:</span><span class="n">hq</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">pposition1</span><span class="p">:</span>
        <span class="c"># passed phase name/number of pposition1 or first positive half</span>
        <span class="c"># quadrant of the circle region phase name/number</span>
        <span class="c"># assign the first position phase number as passed by user arg</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">pposition1</span>
    <span class="c"># end of if sxyphase:</span>

    <span class="n">phases_name</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">pdirection</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;clock&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
        <span class="c"># for clock wise phase increment should be -ve w.r.t phase positions</span>
        <span class="n">inc</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">elif</span> <span class="n">pdirection</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;aclock&#39;</span><span class="p">,</span> <span class="s">&#39;anticlock&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="c"># for anti-clock wise phase increment should be +ve w.r.t</span>
        <span class="c"># phase positions</span>
        <span class="n">inc</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Wrong pdirection &#39;</span><span class="si">%s</span><span class="s">&#39; has passed.</span><span class="se">\</span>
<span class="s">                pass either &#39;clock&#39; or &#39;anticlock&#39;&quot;</span> <span class="o">%</span> <span class="n">pdirection</span><span class="p">)</span>
    <span class="c"># end of if pdirection in [&#39;clock&#39;, 1]:</span>

    <span class="c"># loop through phase positions from 1 to 8.</span>
    <span class="k">for</span> <span class="n">phase_position</span> <span class="ow">in</span> <span class="n">phase_sequence</span><span class="p">:</span>
        <span class="c"># assign the phase name to the corresponding phase position as per</span>
        <span class="c"># user input for the pposition1.</span>
        <span class="n">phases_name</span><span class="p">[</span><span class="n">phase_position</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;PHASE &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="c"># if phase name is reached 8, then next phase name should be 1 in</span>
        <span class="c"># case of anticlock wise direction. inc will take care of the below</span>
        <span class="c"># pos = 0 to convert pos = 1.</span>
        <span class="k">if</span> <span class="n">pos</span> <span class="o">==</span> <span class="mi">8</span> <span class="ow">and</span> <span class="n">inc</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c"># if phase name is reached 1, then next phase name should be 8 in</span>
        <span class="c"># case of clock wise direction. inc will take care of the below</span>
        <span class="c"># pos = 9 to convert pos = 8.</span>
        <span class="k">if</span> <span class="n">pos</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">inc</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="n">pos</span> <span class="o">=</span> <span class="mi">9</span>
        <span class="c"># either increment or decrement w.r.t clock/anticlock wise direction</span>
        <span class="n">pos</span> <span class="o">+=</span> <span class="n">inc</span>
    <span class="c"># end of for phase_position in phase_sequence:</span>

    <span class="c"># draw strings/names of 8 phases inside/outside of the graph</span>
    <span class="k">if</span> <span class="n">plocation</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;in&#39;</span><span class="p">,</span> <span class="s">&#39;inside&#39;</span><span class="p">]:</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">))</span> <span class="ow">in</span> <span class="n">phases_loc_in</span><span class="p">:</span>
            <span class="n">pname</span> <span class="o">=</span> <span class="n">phases_name</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
            <span class="c"># to plot the string w.r.t some x, y position justification</span>
            <span class="c"># must be 0 and location type must be world.</span>
            <span class="n">x</span><span class="o">.</span><span class="n">add_string</span><span class="p">(</span><span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">,</span> <span class="n">pname</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">,</span>
                         <span class="n">char_size</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">just</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="c"># make the loctype as world to recently added string</span>
            <span class="c"># (i.e. the above string added)</span>
            <span class="n">x</span><span class="o">.</span><span class="n">String</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">loctype</span> <span class="o">=</span> <span class="s">&#39;world&#39;</span>
        <span class="c"># end of for (idx, (px, py)) in phases_loc:</span>
    <span class="k">elif</span> <span class="n">plocation</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;out&#39;</span><span class="p">,</span> <span class="s">&#39;outside&#39;</span><span class="p">]:</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">),</span> <span class="n">r</span><span class="p">)</span> <span class="ow">in</span> <span class="n">phases_loc_out</span><span class="p">:</span>
            <span class="n">pname</span> <span class="o">=</span> <span class="n">phases_name</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
            <span class="c"># to plot the string outside with rotation</span>
            <span class="n">x</span><span class="o">.</span><span class="n">add_string</span><span class="p">(</span><span class="n">px</span><span class="p">,</span> <span class="n">py</span><span class="p">,</span> <span class="n">pname</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">,</span>
                         <span class="n">char_size</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="n">r</span><span class="p">,</span> <span class="n">just</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">x</span><span class="o">.</span><span class="n">String</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">loctype</span> <span class="o">=</span> <span class="s">&#39;world&#39;</span>
        <span class="c"># end of for (idx, (px, py), r) in phases_loc_out:</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Wrong plocation &#39;</span><span class="si">%s</span><span class="s">&#39; has passed.</span><span class="se">\</span>
<span class="s">                    pass either &#39;in&#39; or &#39;out&#39;&quot;</span> <span class="o">%</span> <span class="n">plocation</span><span class="p">)</span>
    <span class="c"># end of if plocation in [&#39;in&#39;, &#39;inside&#39;]:</span>

    <span class="c"># set the subtitle1 as year if user not passed</span>
    <span class="n">st1x</span> <span class="o">=</span> <span class="mf">0.72</span> <span class="c">#0.76</span>
    <span class="k">if</span> <span class="n">stitle1</span> <span class="o">==</span> <span class="s">&#39;year&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ptype</span> <span class="o">==</span> <span class="s">&#39;single&#39;</span><span class="p">:</span>
            <span class="n">taxis</span> <span class="o">=</span> <span class="n">xdata</span><span class="o">.</span><span class="n">getTime</span><span class="p">()</span><span class="o">.</span><span class="n">asComponentTime</span><span class="p">()</span>
            <span class="n">syear</span><span class="p">,</span> <span class="n">eyear</span> <span class="o">=</span> <span class="n">taxis</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">taxis</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">year</span>
            <span class="c"># make memory free</span>
            <span class="k">del</span> <span class="n">taxis</span>
        <span class="k">elif</span> <span class="n">ptype</span> <span class="o">==</span> <span class="s">&#39;multi&#39;</span><span class="p">:</span>
            <span class="n">syear</span><span class="p">,</span> <span class="n">eyear</span> <span class="o">=</span> <span class="n">conMonths</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">conMonths</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">year</span>
        <span class="c"># end of if ptype == &#39;single&#39;:</span>
        <span class="n">stitle1</span> <span class="o">=</span> <span class="s">&#39;Year : </span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">syear</span>
        <span class="k">if</span> <span class="n">syear</span> <span class="o">&lt;</span> <span class="n">eyear</span><span class="p">:</span>
            <span class="n">stitle1</span> <span class="o">+=</span> <span class="s">&#39; to </span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">eyear</span>
            <span class="n">st1x</span> <span class="o">=</span> <span class="mf">0.795</span>
    <span class="c"># end of if stitle1 == &#39;year&#39;:</span>

    <span class="c"># set the subtitle2 as season months if user not passed</span>
    <span class="k">if</span> <span class="n">stitle2</span> <span class="o">==</span> <span class="s">&#39;month&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ptype</span> <span class="o">==</span> <span class="s">&#39;single&#39;</span><span class="p">:</span>
            <span class="n">taxis</span> <span class="o">=</span> <span class="n">xdata</span><span class="o">.</span><span class="n">getTime</span><span class="p">()</span><span class="o">.</span><span class="n">asComponentTime</span><span class="p">()</span>
            <span class="n">smon</span> <span class="o">=</span> <span class="n">cdutil</span><span class="o">.</span><span class="n">getMonthString</span><span class="p">(</span><span class="n">taxis</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">month</span><span class="p">)</span>
            <span class="n">emon</span> <span class="o">=</span> <span class="n">cdutil</span><span class="o">.</span><span class="n">getMonthString</span><span class="p">(</span><span class="n">taxis</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">month</span><span class="p">)</span>
            <span class="c"># make memory free</span>
            <span class="k">del</span> <span class="n">taxis</span>
            <span class="n">stitle2</span> <span class="o">=</span> <span class="s">&#39;Season : </span><span class="si">%s</span><span class="s"> to </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">smon</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()[:</span><span class="mi">3</span><span class="p">],</span>
                                             <span class="n">emon</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()[:</span><span class="mi">3</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">ptype</span> <span class="o">==</span> <span class="s">&#39;multi&#39;</span><span class="p">:</span>
            <span class="n">stitle2</span> <span class="o">=</span> <span class="s">&#39;Season : </span><span class="si">%s</span><span class="s"> to </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">conMonths</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()[:</span><span class="mi">3</span><span class="p">],</span>
                                         <span class="n">conMonths</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()[:</span><span class="mi">3</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">stitle2</span> <span class="o">==</span> <span class="s">&#39;date&#39;</span><span class="p">:</span>
        <span class="c"># get the start and end dates</span>
        <span class="n">taxis</span> <span class="o">=</span> <span class="n">xdata</span><span class="o">.</span><span class="n">getTime</span><span class="p">()</span><span class="o">.</span><span class="n">asComponentTime</span><span class="p">()</span>
        <span class="n">stime</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">taxis</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">etime</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">taxis</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">stitle2</span> <span class="o">=</span> <span class="s">&#39;Season : </span><span class="si">%s</span><span class="s"> to </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">stime</span><span class="p">,</span> <span class="n">etime</span><span class="p">)</span>
        <span class="c"># make memory free</span>
        <span class="k">del</span> <span class="n">taxis</span>
    <span class="c"># end of if stitle2 == &#39;month&#39;:</span>
    <span class="c"># draw the title, subtitle1 and subtitle2</span>
    <span class="n">x</span><span class="o">.</span><span class="n">add_string</span><span class="p">(</span><span class="mf">0.52</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">,</span> <span class="n">char_size</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">just</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">x</span><span class="o">.</span><span class="n">add_string</span><span class="p">(</span><span class="n">st1x</span><span class="p">,</span> <span class="mf">0.86</span><span class="p">,</span> <span class="n">stitle1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">,</span> <span class="n">char_size</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">just</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">x</span><span class="o">.</span><span class="n">add_string</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.84</span><span class="p">,</span> <span class="n">stitle2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">,</span> <span class="n">char_size</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">just</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">credits</span><span class="p">:</span>
        <span class="c"># draw the footer comment</span>
        <span class="n">created_on</span> <span class="o">=</span> <span class="s">&#39;Created On : &#39;</span> <span class="o">+</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">&#39;%Y-%m-</span><span class="si">%d</span><span class="s"> %H:%M:%S %Z&#39;</span><span class="p">)</span>
        <span class="n">x</span><span class="o">.</span><span class="n">add_string</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="n">credits</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">,</span> <span class="n">char_size</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">just</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">x</span><span class="o">.</span><span class="n">add_string</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="n">created_on</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">,</span> <span class="n">char_size</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">just</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="c"># end of if credits:</span>

    <span class="c"># draw the centred title / circle title</span>
    <span class="n">x</span><span class="o">.</span><span class="n">add_string</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ctitle</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">,</span> <span class="n">char_size</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">just</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">x</span><span class="o">.</span><span class="n">String</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">loctype</span> <span class="o">=</span> <span class="s">&#39;world&#39;</span>
    <span class="c"># update the x to plot all the strings</span>
    <span class="n">x</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">x</span>
<span class="c"># end of def phase3d(xdata, ydata, ...):</span>

</div>
<div class="viewcode-block" id="mjo_phase3d"><a class="viewcode-back" href="../mjo.html#phase3d.mjo_phase3d">[docs]</a><span class="k">def</span> <span class="nf">mjo_phase3d</span><span class="p">(</span><span class="n">npc1</span><span class="p">,</span> <span class="n">npc2</span><span class="p">,</span> <span class="n">sxyphase</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">dmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dmax</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;magenta&#39;</span><span class="p">,</span> <span class="s">&#39;blue&#39;</span><span class="p">,</span> <span class="s">&#39;violet&#39;</span><span class="p">,</span> <span class="s">&#39;green&#39;</span><span class="p">,</span> <span class="s">&#39;orange&#39;</span><span class="p">,</span> <span class="s">&#39;red&#39;</span><span class="p">],</span>
        <span class="n">tcomment</span><span class="o">=</span><span class="s">&#39;Western Pacific&#39;</span><span class="p">,</span> <span class="n">bcomment</span><span class="o">=</span><span class="s">&#39;Indian Ocean&#39;</span><span class="p">,</span>
        <span class="n">lcomment</span><span class="o">=</span><span class="s">&#39;Western Hemisphere &amp; Africa&#39;</span><span class="p">,</span>
        <span class="n">rcomment</span><span class="o">=</span><span class="s">&#39;Maritime Continent&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;MJO Phase diagram of PC-1 and PC-2&#39;</span><span class="p">,</span>
        <span class="n">stitle1</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">stitle2</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span>
        <span class="n">ctitle</span><span class="o">=</span><span class="s">&#39;Weak MJO&#39;</span><span class="p">,</span> <span class="n">pposition1</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pdirection</span><span class="o">=</span><span class="s">&#39;anticlock&#39;</span><span class="p">,</span>
        <span class="n">plocation</span><span class="o">=</span><span class="s">&#39;in&#39;</span><span class="p">,</span> <span class="n">mintick</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwarg</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    mjo_phase3d : Madden-Julian Oscillation Phase 2 Dimensional Diagram of</span>
<span class="sd">                  3D Var (pcs1, pcs2 &amp; time)</span>

<span class="sd">    Inputs :</span>
<span class="sd">        npc1 : Normalized PC1 (xdata)</span>
<span class="sd">        npc2 : Normalized PC2 (ydata)</span>
<span class="sd">        sxyphase : phase number of start x,y points of npc1, npc2. By default</span>
<span class="sd">                   it takes None. For the simplicity to the user, passed the</span>
<span class="sd">                   default/correct argument to the pposition1 as 5.</span>
<span class="sd">        pposition1 : phase number of the phase position1 of the graph. For the</span>
<span class="sd">                     MJO it must be 5. User can over write the sxyphase and</span>
<span class="sd">                     pposition1 args while calling this function, if needed.</span>
<span class="sd">        pdirection : By default it takes &#39;anticlock&#39; to this MJO.</span>
<span class="sd">        plocation : Phase name/string drawn inside/outside of the graph. By</span>
<span class="sd">                    default it takes &#39;in&#39;.</span>
<span class="sd">        colors : list contains 6 colors to indicate 6 months dataset. User</span>
<span class="sd">                 can overwrite it either by single or many color.</span>
<span class="sd">    Return :</span>
<span class="sd">        It should return the &#39;x&#39; of the xmgrace object which has plotted the</span>
<span class="sd">        data with this MJO args. User can either save it into ps, pdf, etc.,</span>
<span class="sd">        or modify/update further.</span>

<span class="sd">    Refer : phase3d() for the detailed documents of all the arguments.</span>

<span class="sd">    Plot Properties Reference :</span>
<span class="sd">                    http://climate.snu.ac.kr/mjo_diagnostics/index.htm</span>

<span class="sd">    Author : Arulalan.T</span>

<span class="sd">    Date : 20.02.2013</span>

<span class="sd">    License : GPL V3</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">phase3d</span><span class="p">(</span><span class="n">npc1</span><span class="p">,</span> <span class="n">npc2</span><span class="p">,</span> <span class="n">sxyphase</span><span class="p">,</span> <span class="n">dmin</span><span class="p">,</span> <span class="n">dmax</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">tcomment</span><span class="p">,</span>
                   <span class="n">bcomment</span><span class="p">,</span> <span class="n">lcomment</span><span class="p">,</span> <span class="n">rcomment</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">stitle1</span><span class="p">,</span> <span class="n">stitle2</span><span class="p">,</span>
                   <span class="n">ctitle</span><span class="p">,</span> <span class="n">pposition1</span><span class="o">=</span><span class="n">pposition1</span><span class="p">,</span> <span class="n">pdirection</span><span class="o">=</span><span class="n">pdirection</span><span class="p">,</span>
                   <span class="n">plocation</span><span class="o">=</span><span class="n">plocation</span><span class="p">,</span> <span class="n">mintick</span><span class="o">=</span><span class="n">mintick</span><span class="p">,</span> <span class="o">**</span><span class="n">kwarg</span><span class="p">)</span>
<span class="c"># end of mjo_phase3d(npc1, npc2, ...):</span>

</div>
<div class="viewcode-block" id="miso_phase3d"><a class="viewcode-back" href="../mjo.html#phase3d.miso_phase3d">[docs]</a><span class="k">def</span> <span class="nf">miso_phase3d</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">sxyphase</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">dmin</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">dmax</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
        <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;violet&#39;</span><span class="p">,</span> <span class="s">&#39;green&#39;</span><span class="p">,</span> <span class="s">&#39;orange&#39;</span><span class="p">,</span> <span class="s">&#39;red&#39;</span><span class="p">],</span>
        <span class="n">tcomment</span><span class="o">=</span><span class="s">&#39;Centre India &amp; North India&#39;</span><span class="p">,</span> <span class="n">bcomment</span><span class="o">=</span><span class="s">&#39;Southern tp &amp; IO&#39;</span><span class="p">,</span>
        <span class="n">lcomment</span><span class="o">=</span><span class="s">&#39;Peninsular &amp; Centre India&#39;</span><span class="p">,</span> <span class="n">rcomment</span><span class="o">=</span><span class="s">&#39;FootHill &amp; SIO&#39;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s">&#39;Indian Monsoon Intraseasonal Oscillation Index&#39;</span><span class="p">,</span>
        <span class="n">stitle1</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">stitle2</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">ctitle</span><span class="o">=</span><span class="s">&#39;Weak MISO&#39;</span><span class="p">,</span>
        <span class="n">pposition1</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">pdirection</span><span class="o">=</span><span class="s">&#39;clock&#39;</span><span class="p">,</span> <span class="n">plocation</span><span class="o">=</span><span class="s">&#39;out&#39;</span><span class="p">,</span> <span class="n">mintick</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="o">**</span><span class="n">kwarg</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    miso_phase3d : Monsoon Intraseasonal Oscillation Phase 2 Dimensional</span>
<span class="sd">                   Diagram of 3D Var (pcs1, pcs2 &amp; time)</span>
<span class="sd">    Inputs :</span>
<span class="sd">        xdata : Normalized PC1 or relevant data</span>
<span class="sd">        ydata : Normalized PC2 or relevant data</span>
<span class="sd">        sxyphase : phase number of start x,y points of npc1, npc2. By default</span>
<span class="sd">                   it takes None. For the simplicity to the user, passed the</span>
<span class="sd">                   default/correct argument to the pposition1 as 8.</span>
<span class="sd">        pposition1 : phase number of the phase position1 of the graph. For the</span>
<span class="sd">                     MJO it must be 8. User can over write the sxyphase and</span>
<span class="sd">                     pposition1 args while calling this function, if needed.</span>
<span class="sd">        pdirection : By default it takes &#39;clock&#39; to this MJO.</span>
<span class="sd">        plocation : Phase name/string drawn inside/outside of the graph. By</span>
<span class="sd">                    default it takes &#39;in&#39;.</span>
<span class="sd">        colors : list contains 6 colors to indicate 6 months dataset. User</span>
<span class="sd">                 can overwrite it either by single or many color.</span>
<span class="sd">    Return :</span>
<span class="sd">        It should return the &#39;x&#39; of the xmgrace object which has plotted the</span>
<span class="sd">        data with this MJO args. User can either save it into ps, pdf, etc.,</span>
<span class="sd">        or modify/update further.</span>

<span class="sd">    Refer : phase3d() for the detailed documents of all the arguments.</span>

<span class="sd">    Plot Properties Reference : &quot;An Indian monsoon intraseasonal oscillations</span>
<span class="sd">         (MISO) index for real time monitoring and forecast verification&quot;,</span>
<span class="sd">         E. Suhas , J. M. Neena , B. N. Goswami, Clim Dyn,</span>
<span class="sd">         DOI 10.1007/s00382-012-1462-5</span>

<span class="sd">    Author : Arulalan.T</span>

<span class="sd">    Date : 20.02.2013</span>

<span class="sd">    License : GPL V3</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">phase3d</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">sxyphase</span><span class="p">,</span> <span class="n">dmin</span><span class="p">,</span> <span class="n">dmax</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">tcomment</span><span class="p">,</span>
                   <span class="n">bcomment</span><span class="p">,</span> <span class="n">lcomment</span><span class="p">,</span> <span class="n">rcomment</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">stitle1</span><span class="p">,</span> <span class="n">stitle2</span><span class="p">,</span>
                   <span class="n">ctitle</span><span class="p">,</span> <span class="n">pposition1</span><span class="o">=</span><span class="n">pposition1</span><span class="p">,</span> <span class="n">pdirection</span><span class="o">=</span><span class="n">pdirection</span><span class="p">,</span>
                   <span class="n">plocation</span><span class="o">=</span><span class="n">plocation</span><span class="p">,</span> <span class="n">mintick</span><span class="o">=</span><span class="n">mintick</span><span class="p">,</span> <span class="o">**</span><span class="n">kwarg</span><span class="p">)</span>
<span class="c"># end of miso_phase3d(npc1, npc2, ...):</span>
</pre></div></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../index.html">mmDiagnosis 1a documentation</a> &raquo;</li>
          <li><a href="index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2015, Arulalan.T, Dr.Krishna AchutaRao, Dileepkumar.R.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b1.
    </div>
  </body>
</html>